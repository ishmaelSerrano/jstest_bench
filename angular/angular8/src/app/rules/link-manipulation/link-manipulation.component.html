<app-rule [rule]="rule"></app-rule>

<p>The following link is vulnerable: <a id="vulnerableLink" href="https://www.google.com">Vulnerable Link.</a></p>

<ul ngbNav #nav="ngbNav" [(activeId)]="activeIdString" class="nav-tabs">
  <li [ngbNavItem]="'tab1'">
    <a ngbNavLink>Sinks</a>
    <ng-template ngbNavContent>
      <pre>
{{ rule.sinks }}
      </pre>
    </ng-template>
  </li>

  <li [ngbNavItem]="'tab2'">
    <a ngbNavLink>URL Sources</a>
    <ng-template ngbNavContent>
      <div class="sink">
        <button (click)="loadHash()">Click here to load the URL hash into the above vulnerable link.</button>
      </div>
    </ng-template>
  </li>

  <li [ngbNavItem]="'tab3'">
    <a ngbNavLink>Window/Document Sources</a>
    <ng-template ngbNavContent>
      <div class="sink">
        <h5>Text Input:</h5>
        <p>Insert a malicious value to insert into the above vulnerable link.</p>
        <form (submit)="loadInput(dangerousCookieInput.value)">
          <input type="text" #dangerousCookieInput>
          <input type="submit" value="Submit">
        </form>
      </div>
    </ng-template>
  </li>

  <li [ngbNavItem]="'tab4'">
      <a ngbNavLink>Communication Sources</a>
      <ng-template ngbNavContent>
      <div class="sink">
        <button (click)="checkForCookie()">Click here to load cookie named 'manipulatedLink' into the above vulnerable link.</button>
      </div>
    </ng-template>
  </li>

</ul>
<div [ngbNavOutlet]="nav" class="mt-2"></div>
